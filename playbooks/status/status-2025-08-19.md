# Session Status — 2025-08-19

## What we completed today
- **Scaffolded monorepo** structure and docs (Podman-first, agent-first).
- **Agent configs** populated with Playbook-style `agent.yaml` and standardized:
  - `logging.oftx.local_state: /app/data/state.db`
  - `wiring.db_agg_ingest_url` → port **3516**
  - Corrected `network.port` indentation where needed
- **Compose files:**
  - `eos/compose/core.podman.yml` drafted (rootless-Podman friendly; named volumes at `/app/data`; config bind at `/app/config/agent.yaml:ro`)
  - `eos/compose/runtime.podman.yml` overlay for dev (`app` service, workspace bind, knowledge mounts, `env_file: config/env`)
- **Docs & helpers:**
  - Paste-safe rules added to playbooks and CLAUDE project guide
  - `scripts/check-compose.sh` (print-only) created
  - Dry-run guides/checklists added under `workspaces/ws-example` (earlier); current SR2 revealed path checks should be at repo root (see below)

## Validations that passed
- **Core dry-run**: ports OK; `/app/config/agent.yaml` and `/app/data` present for all core services (counts = 10)
- **Overlay dry-run**: `app` present; binds OK (`/workspace`, `/opt/knowledge/snapshots`, `/opt/knowledge/indexes`); `env_file: config/env` present
- No images pulled, no containers started

## Issues discovered (and fixes)
1) **SR2 Step 2 path checks were pointed under `eos/`**  
   - Incorrect: `$DEV_ROOT/eos/workspaces/ws-example`, `$DEV_ROOT/eos/config`  
   - **Correct:** `$DEV_ROOT/workspaces/ws-example`, `$DEV_ROOT/config`
2) **`podman machine ls --format` template error on 5.6.0**  
   - Field `.SSHRemotePort` not available.  
   - **Fix:** use plain `podman machine ls` (no `--format`) or `--format json` and read minimally.

## Where to resume (Next session)
1. **SR2 (revised) — reorient and validate only**  
   - Use correct paths at repo root: `workspaces/ws-example`, `config`  
   - Use `podman machine ls` with **no format template**
2. **Repo push**  
   - Initialize git if needed → first commit → set `origin` → `git push -u origin main` (CLI or `gh`)
3. **Add the two playbooks from this handoff**  
   - Place both files under `playbooks/` and commit
4. **Create `reference/` structure**  
   - Folders: `reference/_incoming`, `reference/raw`, `reference/curated`; add `reference/index.yml`
5. **Optional: controlled single-service up (configuration)**  
   - Bring up with `--no-deps`, verify mounts with `podman inspect`, then stop & remove

## Known good ports & mounts (for quick visual diff)
- Ports: `3510, 3511, 3512, 3515, 3516, 3517, 3434, 3000, 3521, 3522, 8080`
- Binds (each core service): `/app/config/agent.yaml:ro`
- Mounts (each core service): `/app/data` containing `state.db`

## Parking lot / backlog
- GitHub branch protections on `main`
- Webhook listener (pull→build→redeploy)
- MCP auth normalization & secrets policy
- Aggregator DB design (Phase 2)
- Agent templates under `eos/agents/agent-template/`